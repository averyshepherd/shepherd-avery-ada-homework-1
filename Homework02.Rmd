---
title: "Homework02"
author: "Avery Shepherd"
date: "3/22/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(cowplot)
```


```{r}
f <- "https://raw.githubusercontent.com/difiore/ADA-datasets/master/IMDB-movies.csv"
d <- read_csv(f,  col_names = T)
```

Use a one-line statement to filter the dataset to include just movies from 1920 to 1979 and movies that are between 1 and 3 hours long (runtimeMinutes < 240), and add a new column that codes the startYear into a new variable, decade (“20s,” “30s,” …“70s”). If you do this correctly, there should be 5651 movies remaining in the dataset.
```{r}
new_d <- d %>% filter(startYear >= 1920 & startYear <= 1979) %>% 
  filter(runtimeMinutes <= 180 & runtimeMinutes >= 60) %>% 
  mutate(decade = case_when(startYear >= 1920 & startYear < 1930 ~ "20s",
                          startYear >= 1930 & startYear < 1940 ~ "30s",
                          startYear >= 1940 & startYear < 1950 ~ "40s",
                          startYear >= 1950 & startYear < 1960 ~ "50s",
                          startYear >= 1960 & startYear < 1970 ~ "60s",
                          startYear >= 1970 & startYear < 1980 ~ "70s"))
new_d
```


```{r}
new_d %>% ggplot(aes(x = runtimeMinutes)) +
  geom_histogram() + 
  facet_wrap(~ decade)
```

Use a one-line statement to calculate the population mean and population standard deviation in runtimeMinutes for each decade and save the results in a new dataframe, results.
```{r}
results <- new_d %>% group_by(decade) %>% summarise(runtime_mean = mean(runtimeMinutes), std_dev = sd(runtimeMinutes), name = "pop")
results
```

Draw a single sample of 100 movies, without replacement, from each decade, calculate this single sample mean and sample standard deviation in runtimeMinutes, and estimate the SE around the population mean runtimeMinutes for each decade based on the standard deviation and sample size from these samples.
```{r}
set.seed(100)
sample_results <- new_d %>% group_by(decade) %>% sample_n(100) %>% summarise(runtime_mean = mean(runtimeMinutes), std_dev = sd(runtimeMinutes), name = "sample")
```

Compare these estimates to the actual population mean runtimeMinutes for each decade and to the calculated SE in the population mean for samples of size 100 based on the population standard deviation for each decade.
```{r}
p1 <- rbind(sample_results, results) %>% 
  ggplot(aes(x = name, y = runtime_mean)) + geom_point() + facet_wrap(~decade)
p2 <- rbind(sample_results, results) %>% 
  ggplot(aes(x = name, y = std_dev)) + geom_point() + facet_wrap(~decade)
plot_grid(p1, p2)
```

Generate a sampling distribution of mean runtimeMinutes for each decade by [a] drawing 1000 samples of 100 movies from each decade and, for each sample, [b] calculating the mean runtimeMinutes and the standard deviation in runtimeMinutes
```{r}
s <- data.frame()
for (i in 1:1000) {
  smple <- new_d %>% group_by(decade) %>% sample_n(100) %>% summarise(runtime_mean = mean(runtimeMinutes), std_dev = sd(runtimeMinutes), sample_num = i)
  s <- rbind(s, smple)
}
```

Then, calculate the MEAN and the STANDARD DEVIATION of the sampling distribution of sample means for each decade (the former should be a very good estimate of the population mean, while the latter is another estimate of the standard error in the population mean for a particular sample size)
```{r}
(distribution_results <- s %>% group_by(decade) %>% summarise(runtime_mean = mean(runtime_mean), std_dev = sd(std_dev), name = "distribution"))
```

plot a histogram of the sampling distribution. What shape does it have?
*normally distributed*
```{r}
ggplot(s, aes(x = runtime_mean)) + geom_histogram() + facet_wrap(~ decade)
```

Finally, compare the standard error in runtimeMinutes for samples of size 100 from each decade [1] as estimated from your first sample of 100 movies, [2] as calculated from the known population standard deviations for each decade, and [3] as estimated from the sampling distribution of sample means.
```{r}
standard_errors <- rbind(sample_results, results, distribution_results)
ggplot(data = standard_errors, aes(x = name, y = std_dev)) + 
  geom_point() + facet_wrap(~ decade)
```


```{r}

```


```{r}

```


```{r}

```